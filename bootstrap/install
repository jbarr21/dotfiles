#!/usr/bin/env bash

OS=$(uname -s)
REPO="$(git rev-parse --show-toplevel)"
pushd $REPO
git submodule update --init --recursive

if [ $OS = "Darwin" ]; then
  echo "Install OSX defaults"
  source ./bootstrap/brew-install
else
  source ./bootstrap/apt-install
fi

#Backs up old files
[ -f ~/.zshrc ] && [ ! -f ~/.zshrc.original ] && mv ~/.zshrc ~/.zshrc.original
[ -f ~/.gitconfig ] && [ ! -f ~/.gitconfig.original ] && mv ~/.gitconfig ~/.gitconfig.original
[ -f ~/.tmux.conf ] && [ ! -f ~/.tmux.conf.original ] && mv ~/.tmux ~/.tmux.conf.original

echo "Linking home files"
# - clean: ['~', '~/bin']
bootstrap/setup-home
popd

echo "finished! restart shell."



# - shell:
#   -
#     if: "[ -z \"$SKIP_PKG\" ]"
#     command: cat ./bootstrap/cargo | xargs cargo install
#     description: Installing Rust packages
#   -
#     if: "[ -z \"$SKIP_PKG\" ]"
#     command: cat ./bootstrap/npm | xargs npm -g install
#     description: Installing NPM packages
#   -
#     if: "[ -z \"$SKIP_PKG\" ]"
#     command: ./bootstrap/go
#     description: Installing Go packages
#   -
#     if: "[ -z \"$SKIP_PKG\" ]"
#     command: cat ./bootstrap/pip | xargs pip3 install
#     description: Installing Python3 packages
#   -
#     if: "[ -z \"$SKIP_PKG\" ]"
#     command: cat ./bootstrap/pip | xargs pip install
#     description: Installing Python packages